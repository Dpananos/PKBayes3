"0","concentration_profile<-function(time, D=2.5, V=5.0, ka=0.3, ke=0.15){"
"0","  y = D/V * ka/(ke-ka) *(exp(-ka*time) - exp(-ke*time))"
"0","  "
"0","  ix = which(y<0)"
"0","  "
"0","  y[ix] = 0"
"0","  "
"0","  y"
"0","}"
"0",""
"0","dose_times = seq(0, 60, 12)"
"0","times = seq(0, 60, 1.5)"
"0","C = rep(0, length(times))"
"0","for(i in dose_times){"
"0","  C = C + concentration_profile(times-i)"
"0","}"
"0",""
"0","tibble(t = times, y = C) %>% "
"0","  ggplot(aes(t, C))+"
"0","  geom_point(color = 'blue')+"
"0","  geom_line(color = 'blue')+"
"0","  stat_function(fun=concentration_profile, alpha=0.5, color = 'blue')+"
"0","  stat_function(fun=function(x) concentration_profile(x-12), alpha=0.5, color = 'blue')+"
"0","  stat_function(fun=function(x) concentration_profile(x-24), alpha=0.5, color = 'blue')+"
"0","  stat_function(fun=function(x) concentration_profile(x-36), alpha=0.5, color = 'blue')+"
"0","  stat_function(fun=function(x) concentration_profile(x-48), alpha=0.5, color = 'blue')+"
"0","  theme(aspect.ratio = 1)+"
"0","  labs(x='Time', y='Concentration')"
